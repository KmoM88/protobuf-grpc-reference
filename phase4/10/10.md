# Chapter 10: Metadata & Security
Metadata and security are fundamental components of production gRPC systems. Metadata handles the contextual, non-application data (like authorization), while Security ensures the communication channel is protected using TLS and mTLS.

## 10.1. What is Metadata? (Headers/Trailers).
Metadata in gRPC is a set of key-value pairs (strings) that are sent with the RPC call, similar to HTTP headers. It conveys auxiliary information that is not part of the actual Protobuf payload.

- Headers: Metadata sent before the actual RPC request or response messages begin streaming. This is typically used for authentication, tracing IDs, or configuration flags.
- Trailers: Metadata sent after all request or response messages have been streamed, just before the final status is returned. This is less common but can be used to send final status summaries or resource consumption statistics.
- Metadata is essential because it is accessible by interceptors (middleware) on both the client and server before processing the main message payload.

## 10.2. Sending Auth Tokens (JWT) via metadata.
The standard way to authenticate gRPC clients is by passing an Authentication Token (like a JWT or API Key) in the metadata headers.

- Client: The client intercepts the outgoing RPC call and injects the token into the metadata, typically using the key authorization with the format: Bearer [token].
- Server: The server's interceptor (middleware) extracts the authorization metadata before the RPC handler is invoked.
- Validation: The server validates the token (e.g., checks the JWT signature and expiration). If validation fails, the server immediately terminates the RPC with an error status like UNAUTHENTICATED (16). If successful, the request proceeds.

## 10.3. TLS/SSL: Setting up secure credentials.
TLS (Transport Layer Security), often referred to as SSL, is the standard mechanism for encrypting communication between the gRPC client and server. This prevents eavesdropping and ensures data confidentiality.

- Server Setup: The server must load a private key and a public certificate signed by a trusted Certificate Authority (CA). The gRPC server is then configured to listen using these credentials.
- Client Setup: The client must load the CA root certificate (the public certificate used to sign the server's certificate). This allows the client to verify the identity of the server before sending any data.

Key Concept: Standard TLS provides Server Authenticationâ€”the client verifies the server's identity.

## 10.4. mTLS (Mutual TLS): Configuring certificates for Zero Trust.
mTLS (Mutual TLS) extends standard TLS by requiring both the client and the server to present and verify certificates.

- Zero Trust: mTLS is a cornerstone of the Zero Trust security model, where no entity (client or server) is trusted by default. Every connection must be cryptographically verified.
- Process:
	- Server presents its certificate to the Client.
	- Client verifies the Server's certificate.
	- Client presents its own certificate to the Server.
	- Server verifies the Client's certificate.

This ensures that only clients with valid, pre-approved certificates can even establish a connection, making mTLS ideal for securing communication between microservices within a private network.